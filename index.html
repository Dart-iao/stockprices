<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dart App</title>
    <link rel="apple-touch-icon" href="https://dart-iao.github.io/stockprices/static/darticon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://dart-iao.github.io/stockprices/static/darticon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://dart-iao.github.io/stockprices/static/darticon.png">
    <link rel="apple-touch-icon" sizes="167x167" href="https://dart-iao.github.io/stockprices/static/darticon.png">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        // Icon components
        const TrendingUp = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>);
        const Star = ({ fill }) => (<svg width="24" height="24" viewBox="0 0 24 24" fill={fill ? "currentColor" : "none"} stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>);
        const ThumbsUp = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>);
        const Activity = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>);
        const DollarSign = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>);
        const Home = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>);
        const Coffee = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>);
        const MessageSquare = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>);
        const Clock = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>);

        function QuickMovers() {
            const [currentPage, setCurrentPage] = useState('main');
            const [selectedStock, setSelectedStock] = useState(null);
            const [feedback, setFeedback] = useState('');
            const [email, setEmail] = useState('');
            const [topMovers, setTopMovers] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState('');
            const [lastUpdated, setLastUpdated] = useState('');
            const [predictions, setPredictions] = useState([]);
            const [predictionHistory, setPredictionHistory] = useState([]);

            // Fetch top movers
            useEffect(() => {
               fetch('https://adrianhutchins.pythonanywhere.com/static/stocks.json')
                    .then(res => res.json())
                    .then(data => {
                        setTopMovers(data.stocks || []);
                        setLastUpdated(data.updateTime || new Date().toLocaleString());
                        setLoading(false);
                    })
                    .catch((err) => {
                        console.error('Error fetching stocks:', err);
                        setError('Unable to load stocks. Please check your connection.');
                        setLoading(false);
                    });
            }, []);

            // Fetch predictions
            useEffect(() => {
               fetch('https://adrianhutchins.pythonanywhere.com/static/predictions.json')
                    .then(res => res.json())
                    .then(data => {
                        setPredictions(data.predictions || []);
                    })
                    .catch((err) => {
                        console.error('Error fetching predictions:', err);
                        setPredictions([]);
                    });
            }, []);

            // Fetch prediction history
            useEffect(() => {
                fetch('https://adrianhutchins.pythonanywhere.com/static/prediction_history.json')
                    .then(res => res.json())
                    .then(data => {
                        setPredictionHistory(data.history || []);
                    })
                    .catch((err) => {
                        console.error('Error fetching prediction history:', err);
                        setPredictionHistory([]);
                    });
            }, []);

            const isValidEmail = (e) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
            const isFormValid = feedback.trim() && email.trim() && isValidEmail(email);
            
            // Color code key factors
            const getFactorColor = (factor) => {
                const lowerFactor = factor.toLowerCase();
                
                // Good (green)
                const goodKeywords = ['oversold', 'high volume', 'momentum', 'bullish', 'breakthrough', 'upgrade', 'approval', 'deal', 'partnership', 'breakout'];
                if (goodKeywords.some(keyword => lowerFactor.includes(keyword))) {
                    return 'bg-green-100 text-green-800';
                }
                
                // Bad (red)
                const badKeywords = ['overbought', 'bearish', 'downgrade', 'concern', 'warning', 'loss', 'decline', 'weak'];
                if (badKeywords.some(keyword => lowerFactor.includes(keyword))) {
                    return 'bg-red-100 text-red-800';
                }
                
                // Neutral (gray) - default
                return 'bg-gray-100 text-gray-800';
            };
            
            // Generate key factors for yesterday's movers based on their data
            const generateKeyFactors = (stock) => {
                const factors = [];
                
                // Check for big move
                if (stock.percentChange >= 30) {
                    factors.push('Big move');
                } else if (stock.percentChange >= 20) {
                    factors.push('Momentum');
                }
                
                // Check for high volume if available
                if (stock.relativeVolume && stock.relativeVolume > 2) {
                    factors.push('High volume');
                } else if (stock.relativeVolume && stock.relativeVolume > 1.5) {
                    factors.push('Volume spike');
                }
                
                // Check RSI if available
                if (stock.rsi) {
                    if (stock.rsi < 30) {
                        factors.push('Oversold');
                    } else if (stock.rsi > 70) {
                        factors.push('Overbought');
                    }
                }
                
                // Check gap if available
                if (stock.gapPercent && stock.gapPercent > 10) {
                    factors.push('Gap up');
                }
                
                // If no factors, add a neutral one
                if (factors.length === 0) {
                    factors.push('Price action');
                }
                
                return factors;
            };
            
            // Main Page
            if (currentPage === 'main') return (
                <div className="min-h-screen bg-white p-4 pb-24">
                    <div className="max-w-6xl mx-auto mb-6">
                        <div className="flex items-center justify-between mb-2">
                            <h1 className="text-3xl font-bold">Quick Movers</h1>
                            <div className="flex items-center gap-2 bg-pink-100 px-3 py-2 rounded-lg">
                                <div className="text-pink-500"><Activity /></div>
                                <span className="text-sm font-medium text-pink-500">6 AM Updates</span>
                            </div>
                        </div>
                        {lastUpdated && <p className="text-xs text-gray-500 mt-1">Last updated: {lastUpdated}</p>}
                        {error && <div className="mt-4 bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-600">{error}</div>}
                    </div>
                    
                    <div className="max-w-6xl mx-auto mb-8 bg-gray-50 rounded-lg p-4 border">
                        <h2 className="text-xl font-bold flex items-center gap-2 mb-4"><div className="text-pink-500"><ThumbsUp /></div>Likely to move today</h2>
                        {predictions.length === 0 ? (
                            <div className="text-center py-12"><p className="text-gray-600">Generating predictions... Check back soon!</p></div>
                        ) : (
                            <div className="space-y-2">
                                {predictions.map(pred => (
                                    <div key={pred.ticker} onClick={() => { setSelectedStock({...pred, isPrediction: true}); setCurrentPage('detail'); }} className="bg-white rounded-lg p-3 border hover:border-purple-500 cursor-pointer">
                                        <div className="flex justify-between mb-2"><div className="flex gap-2"><span className="font-bold">{pred.ticker}</span><span className="text-xs text-gray-600">{pred.name}</span></div><div className="bg-purple-200 text-purple-800 px-2 py-0.5 rounded-full text-xs">{pred.confidence}%</div></div>
                                        <div className="text-xs"><span className="text-gray-600">Predicted: </span><span className="text-purple-600 font-bold">{pred.predictedMove}</span></div>
                                        <div className="flex flex-wrap gap-1 mt-2">
                                            {pred.keyFactors.map((factor, idx) => (
                                                <span key={idx} className={`px-2 py-0.5 rounded text-xs ${getFactorColor(factor)}`}>{factor}</span>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="max-w-6xl mx-auto mb-8 bg-gray-50 rounded-lg p-4 border">
                        <h2 className="text-xl font-bold flex items-center gap-2 mb-4"><TrendingUp />Yesterday's movers</h2>
                        <p className="text-sm text-gray-600 mb-4">These stocks under $10 moved 20% over the last two days.<br/>Caution: these may not move anymore because of yesterday's jump.</p>
                        {loading ? (
                            <div className="text-center py-12"><Activity /><p className="text-gray-600">Loading...</p></div>
                        ) : topMovers.length === 0 ? (
                            <div className="text-center py-12"><p className="text-gray-600">No stocks found with 20%+ movement. Check back at 6 AM.</p></div>
                        ) : (
                            <div className="space-y-2">
                                {topMovers.slice(0, 15).map((stock, idx) => {
                                    const displayFactors = stock.keyFactors || generateKeyFactors(stock);
                                    const isDuplicate = predictions.some(pred => pred.ticker === stock.ticker);
                                    return (
                                        <div key={stock.ticker} onClick={() => { setSelectedStock(stock); setCurrentPage('detail'); }} className={`${isDuplicate ? 'bg-orange-100' : 'bg-white'} rounded-lg p-3 border hover:border-blue-500 cursor-pointer`}>
                                            <div className="flex items-start justify-between gap-2">
                                                <div className="flex items-start gap-3 flex-1">
                                                    <div className="flex-1">
                                                        <div className="flex gap-2"><span className="text-lg font-bold">{stock.ticker}</span><span className="text-xs text-gray-600">{stock.name}</span></div>
                                                        <div className="text-xs text-gray-600 mt-1">{stock.catalyst}</div>
                                                        <div className="flex flex-wrap gap-1 mt-2">
                                                            {displayFactors.map((factor, fIdx) => (
                                                                <span key={fIdx} className={`px-2 py-0.5 rounded text-xs ${getFactorColor(factor)}`}>{factor}</span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="text-right"><div className="text-base font-semibold">${stock.priceToday.toFixed(2)}</div><div className="bg-green-500 text-white px-2 py-0.5 rounded-full text-xs font-bold mt-1">+{stock.percentChange.toFixed(1)}%</div></div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>
                    
                    <div className="max-w-6xl mx-auto mt-6 px-4">
                        <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <p className="text-xs text-gray-700 text-center mb-2">
                                <strong>DISCLAIMER:</strong> This app is for informational and entertainment purposes only. 
                                Nothing on this site constitutes financial, investment, legal, or tax advice. 
                                Stock predictions are based on automated analysis and may be inaccurate. 
                                Past performance does not guarantee future results. Trading stocks involves risk, 
                                including loss of principal. Always do your own research and consult a licensed 
                                financial advisor before making investment decisions. We are not registered investment advisors.
                            </p>
                            <p className="text-xs text-gray-500 text-center">
                                Data sources: Yahoo Finance, NewsAPI, Alpha Vantage, Finviz
                            </p>
                        </div>
                    </div>
                    
                    <div className="fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg" style={{paddingBottom: 'env(safe-area-inset-bottom)'}}>
                        <div className="flex justify-around max-w-lg mx-auto px-4 py-4">
                            <button onClick={() => setCurrentPage('main')} className="flex flex-col items-center gap-1 text-pink-500" style={{marginTop: '-2px'}}><Home /><span className="text-xs">Home</span></button>
                            <button onClick={() => setCurrentPage('predictions')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Clock /><span className="text-xs">Predictions</span></button>
                            <button onClick={() => setCurrentPage('feedback')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><MessageSquare /><span className="text-xs">Feedback</span></button>
                            <button onClick={() => setCurrentPage('coffee')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Coffee /><span className="text-xs">Coffee</span></button>
                        </div>
                    </div>
                </div>
            );
            
            // Detail Page
            if (currentPage === 'detail' && selectedStock) return (
                <div className="min-h-screen bg-white p-4 pb-24">
                    <div className="max-w-4xl mx-auto">
                        <button onClick={() => setCurrentPage('main')} className="flex items-center gap-2 text-pink-500 hover:text-pink-600 mb-4">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                            <span className="font-medium">Back</span>
                        </button>
                        <div className="bg-gray-50 rounded-lg p-4 border mb-4">
                            <div className="flex items-center justify-between mb-4">
                                <div><h1 className="text-3xl font-bold">{selectedStock.ticker}</h1><p className="text-sm text-gray-600">{selectedStock.name}</p></div>
                                <div className="text-right"><div className="text-xs text-gray-600">Movement</div><div className="text-2xl font-bold text-green-600">{selectedStock.isPrediction ? selectedStock.predictedMove : `+${selectedStock.percentChange.toFixed(1)}%`}</div></div>
                            </div>
                            <div className="grid grid-cols-2 gap-4 pt-4 border-t">
                                <div><div className="text-xs text-gray-600">2 Days Ago</div><div className="text-lg font-semibold">${selectedStock.price3DaysAgo.toFixed(2)}</div></div>
                                <div><div className="text-xs text-gray-600">Today</div><div className="text-lg font-semibold">${selectedStock.priceToday.toFixed(2)}</div></div>
                            </div>
                        </div>
                        <div className="space-y-4">
                            {selectedStock.breakoutPotential && (
                                <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-5 border-2 border-purple-300">
                                    <h3 className="font-bold text-purple-700 mb-3 flex items-center gap-2"><Star fill={true} />Breakout Potential Score</h3>
                                    <div className="flex items-center justify-between mb-2"><span className="text-sm font-semibold">Explosive Move Potential</span><span className="text-2xl font-bold text-purple-700">{selectedStock.breakoutPotential}/100</span></div>
                                    <div className="w-full bg-gray-200 rounded-full h-3"><div className="h-3 rounded-full bg-gradient-to-r from-purple-600 to-pink-600" style={{ width: `${selectedStock.breakoutPotential}%` }} /></div>
                                </div>
                            )}
                            {selectedStock.gapPercent && (
                                <div className="bg-gray-50 rounded-lg p-5 border">
                                    <h3 className="font-bold mb-3 flex items-center gap-2"><TrendingUp />Market Gap Analysis</h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="bg-white p-3 rounded border"><div className="text-xs text-gray-600">Gap %</div><div className="text-xl font-bold text-green-600">{selectedStock.gapPercent.toFixed(1)}%</div></div>
                                        <div className="bg-white p-3 rounded border"><div className="text-xs text-gray-600">Relative Volume</div><div className="text-xl font-bold text-blue-600">{selectedStock.relativeVolume}x</div></div>
                                    </div>
                                </div>
                            )}
                            <div className="bg-gray-50 rounded-lg p-5 border">
                                <h3 className="font-bold mb-3 flex items-center gap-2"><DollarSign />Primary Catalyst & Recent News</h3>
                                <p className="text-sm font-semibold mb-2">{selectedStock.catalyst}</p>
                                <p className="text-xs text-gray-600">{selectedStock.news || selectedStock.reasoning}</p>
                            </div>
                            {selectedStock.isPrediction && selectedStock.confidence && (
                                <div className="bg-purple-50 rounded-lg p-5 border-2 border-purple-300">
                                    <h3 className="font-bold text-purple-700 mb-3 flex items-center gap-2"><Star />Prediction Analysis</h3>
                                    <div className="flex items-center justify-between mb-2"><span className="text-sm font-semibold">Confidence Level</span><span className="text-xl font-bold text-purple-700">{selectedStock.confidence}%</span></div>
                                    <div className="w-full bg-gray-200 rounded-full h-3 mb-3"><div className="h-3 rounded-full bg-gradient-to-r from-purple-600 to-pink-600" style={{ width: `${selectedStock.confidence}%` }} /></div>
                                    <p className="text-xs text-gray-700">{selectedStock.reasoning}</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );

            // Predictions History Page
            if (currentPage === 'predictions') {
                // Sort predictions by date (newest first) and limit to 2 weeks (14 days)
                const twoWeeksAgo = new Date();
                twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
                
                const recentPredictions = predictionHistory
                    .filter(pred => new Date(pred.predictionDate) >= twoWeeksAgo)
                    .sort((a, b) => new Date(b.predictionDate) - new Date(a.predictionDate));
                
                // Calculate overall accuracy
                const correctPredictions = recentPredictions.filter(pred => pred.wasCorrect).length;
                const totalPredictions = recentPredictions.length;
                const accuracyPercentage = totalPredictions > 0 ? ((correctPredictions / totalPredictions) * 100).toFixed(1) : 0;
                
                // Calculate yesterday's accuracy for comparison
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().split('T')[0];
                
                const yesterdayPredictions = recentPredictions.filter(pred => 
                    new Date(pred.predictionDate) < yesterday
                );
                const yesterdayCorrect = yesterdayPredictions.filter(pred => pred.wasCorrect).length;
                const yesterdayTotal = yesterdayPredictions.length;
                const yesterdayAccuracy = yesterdayTotal > 0 ? ((yesterdayCorrect / yesterdayTotal) * 100).toFixed(1) : null;
                
                // Calculate change from yesterday
                const accuracyChange = yesterdayAccuracy !== null ? (parseFloat(accuracyPercentage) - parseFloat(yesterdayAccuracy)).toFixed(1) : null;
                
                // Format date to abbreviated format (e.g., "Wed. - October 22")
                const formatDate = (dateStr) => {
                    const date = new Date(dateStr);
                    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                    const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                                    'July', 'August', 'September', 'October', 'November', 'December'];
                    return `${days[date.getDay()]}. - ${months[date.getMonth()]} ${date.getDate()}`;
                };
                
                return (
                    <div className="min-h-screen bg-white p-4 pb-24">
                        <div className="max-w-6xl mx-auto mb-6">
                            <h1 className="text-3xl font-bold mb-2">Prediction History</h1>
                        </div>
                        
                        {/* Gray Container matching home page */}
                        <div className="max-w-6xl mx-auto bg-gray-50 rounded-lg p-4 border">
                            
                            {/* Accuracy Stats - Option A Layout */}
                            {totalPredictions > 0 && (
                                <div className="mb-6">
                                    {/* Big Percentage in White Card */}
                                    <div className="bg-white rounded-xl p-6 border mb-4 text-center">
                                        <div className="text-6xl font-bold text-pink-600 mb-2">{accuracyPercentage}%</div>
                                        <div className="text-lg text-gray-600">Accurate</div>
                                    </div>
                                    
                                    {/* Two Cards Side by Side */}
                                    <div className="grid grid-cols-2 gap-3 mb-3">
                                        <div className="bg-white rounded-lg p-4 border text-center">
                                            <div className="text-sm text-gray-600 mb-1">Change</div>
                                            {accuracyChange !== null ? (
                                                <>
                                                    <div className={`text-xl font-bold ${parseFloat(accuracyChange) >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                        {parseFloat(accuracyChange) >= 0 ? '↑' : '↓'} {Math.abs(accuracyChange)}%
                                                    </div>
                                                    <div className="text-xs text-gray-500">from yesterday</div>
                                                </>
                                            ) : (
                                                <div className="text-xl font-bold text-gray-400">—</div>
                                            )}
                                        </div>
                                        <div className="bg-white rounded-lg p-4 border text-center">
                                            <div className="text-sm text-gray-600 mb-1">Results</div>
                                            <div className="text-xl font-bold text-gray-700">{correctPredictions}/{totalPredictions}</div>
                                            <div className="text-xs text-gray-500">Correct</div>
                                        </div>
                                    </div>
                                    
                                    {/* Subtext */}
                                    <div className="text-xs text-gray-500 italic text-center">
                                        Wrong/Right is based on highest price from 4am-9am
                                    </div>
                                </div>
                            )}
                            
                            {recentPredictions.length === 0 ? (
                            <div className="text-center py-20">
                                <div className="w-20 h-20 mx-auto mb-4 text-gray-300"><Clock /></div>
                                <p className="text-gray-600 text-lg">No prediction history yet</p>
                                <p className="text-gray-500 text-sm mt-2">Check back after predictions are made and verified</p>
                            </div>
                        ) : (
                            <div className="space-y-2">
                                {recentPredictions.map((pred, idx) => (
                                    <div key={idx} className={`bg-white rounded-lg p-3 border-2 ${pred.wasCorrect ? 'border-green-500' : 'border-red-500'}`}>
                                        <div className="flex justify-between items-start mb-2 gap-2">
                                            <div className="flex-1 min-w-0">
                                                <div className="flex gap-2">
                                                    <span className="font-bold">{pred.ticker}</span>
                                                    <span className="text-xs text-gray-600">{pred.name}</span>
                                                </div>
                                            </div>
                                            <div className={`px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-bold whitespace-nowrap flex-shrink-0 ${pred.wasCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                                                {pred.wasCorrect ? '✓ CORRECT' : '✗ WRONG'}
                                            </div>
                                        </div>
                                        <div className="grid grid-cols-2 gap-3 text-xs mb-2">
                                            <div>
                                                <span className="text-gray-600">Predicted: </span>
                                                <span className={`font-semibold ${pred.predictedMove && pred.predictedMove.startsWith('+') ? 'text-green-600' : pred.predictedMove && pred.predictedMove.startsWith('-') ? 'text-red-600' : 'text-gray-700'}`}>
                                                    {pred.predictedMove || 'N/A'}
                                                </span>
                                            </div>
                                            <div>
                                                <span className="text-gray-600">Actual: </span>
                                                <span className={`font-semibold ${pred.actualMove && pred.actualMove.startsWith('+') ? 'text-green-600' : pred.actualMove && pred.actualMove.startsWith('-') ? 'text-red-600' : 'text-gray-700'}`}>
                                                    {pred.actualMove || 'N/A'}
                                                </span>
                                            </div>
                                            <div>
                                                <span className="text-gray-600">Start: </span>
                                                <span className="font-semibold">${pred.predictedPrice !== undefined ? pred.predictedPrice : '0.00'}</span>
                                            </div>
                                            <div>
                                                <span className="text-gray-600">End: </span>
                                                <span className="font-semibold">${pred.actualPrice !== undefined ? pred.actualPrice : '0.00'}</span>
                                            </div>
                                        </div>
                                        <div className="text-xs text-gray-600">
                                            {formatDate(pred.predictionDate)} | Confidence: {pred.confidence !== undefined ? pred.confidence : '0'}%
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                    <div className="fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg" style={{paddingBottom: 'env(safe-area-inset-bottom)'}}>
                        <div className="flex justify-around max-w-lg mx-auto px-4 py-4">
                            <button onClick={() => setCurrentPage('main')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Home /><span className="text-xs">Home</span></button>
                            <button onClick={() => setCurrentPage('predictions')} className="flex flex-col items-center gap-1 text-pink-500" style={{marginTop: '-2px'}}><Clock /><span className="text-xs">Predictions</span></button>
                            <button onClick={() => setCurrentPage('feedback')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><MessageSquare /><span className="text-xs">Feedback</span></button>
                            <button onClick={() => setCurrentPage('coffee')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Coffee /><span className="text-xs">Coffee</span></button>
                        </div>
                    </div>
                </div>
            );
            }
            
            // Feedback Page
            if (currentPage === 'feedback') return (
                <div className="min-h-screen bg-white p-4 pb-24">
                    <div className="max-w-2xl mx-auto">
                        <h1 className="text-3xl font-bold mb-6 text-center">We'd Love Your Input</h1>
                        <div className="bg-gradient-to-br from-pink-50 to-pink-100 rounded-lg p-6 border">
                            <div className="mb-6">
                                <label className="block font-semibold mb-3">Suggestions or Feedback</label>
                                <textarea value={feedback} onChange={(e) => setFeedback(e.target.value)} placeholder="Share your thoughts..." className="w-full h-32 px-4 py-3 border rounded-lg resize-none bg-white" />
                            </div>
                            <div>
                                <label className="block font-semibold mb-3">Email Address</label>
                                <input type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="your.email@example.com" className="w-full px-4 py-3 border rounded-lg bg-white" />
                                {email && !isValidEmail(email) && <p className="text-red-600 text-xs mt-2">Please enter a valid email</p>}
                            </div>
                        </div>
                        <button disabled={!isFormValid} onClick={() => { 
                            // Build the Google Form submission URL with pre-filled data
                            const formId = '1FAIpQLSdPV46GRekasxpBYwYsMkX4YWKmjTwpBEUl0lRPrav8KCORVA';
                            const emailEntryId = '1360878470';
                            const feedbackEntryId = '1214908827';
                            
                            // Encode the values
                            const encodedEmail = encodeURIComponent(email);
                            const encodedFeedback = encodeURIComponent(feedback);
                            
                            // Create the submission URL
                            const submitUrl = `https://docs.google.com/forms/d/e/${formId}/formResponse?entry.${emailEntryId}=${encodedEmail}&entry.${feedbackEntryId}=${encodedFeedback}&submit=Submit`;
                            
                            // Open in hidden iframe
                            const iframe = document.createElement('iframe');
                            iframe.style.display = 'none';
                            iframe.name = 'hidden_iframe';
                            document.body.appendChild(iframe);
                            
                            // Submit to iframe
                            const form = document.createElement('form');
                            form.method = 'POST';
                            form.action = `https://docs.google.com/forms/d/e/${formId}/formResponse`;
                            form.target = 'hidden_iframe';
                            
                            const input1 = document.createElement('input');
                            input1.type = 'hidden';
                            input1.name = `entry.${emailEntryId}`;
                            input1.value = email;
                            form.appendChild(input1);
                            
                            const input2 = document.createElement('input');
                            input2.type = 'hidden';
                            input2.name = `entry.${feedbackEntryId}`;
                            input2.value = feedback;
                            form.appendChild(input2);
                            
                            document.body.appendChild(form);
                            form.submit();
                            
                            // Clean up
                            setTimeout(() => {
                                document.body.removeChild(form);
                                document.body.removeChild(iframe);
                            }, 1000);
                            
                            // Show success and clear form
                            alert('Feedback sent! Thank you! 💖');
                            setFeedback('');
                            setEmail('');
                        }} className={`w-full mt-6 py-4 rounded-lg font-semibold ${isFormValid ? 'bg-gradient-to-br from-pink-100 to-pink-200' : 'bg-gray-200 text-gray-400'}`}>Let Her Know</button> 
                        <p className="text-xs text-gray-400 italic text-center mt-4">Your email information will be shared.</p>
                    </div>
                    <div className="fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg" style={{paddingBottom: 'env(safe-area-inset-bottom)'}}>
                        <div className="flex justify-around max-w-lg mx-auto px-4 py-4">
                            <button onClick={() => setCurrentPage('main')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Home /><span className="text-xs">Home</span></button>
                            <button onClick={() => setCurrentPage('predictions')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Clock /><span className="text-xs">Predictions</span></button>
                            <button onClick={() => setCurrentPage('feedback')} className="flex flex-col items-center gap-1 text-pink-500" style={{marginTop: '-2px'}}><MessageSquare /><span className="text-xs">Feedback</span></button>
                            <button onClick={() => setCurrentPage('coffee')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Coffee /><span className="text-xs">Coffee</span></button>
                        </div>
                    </div>
                </div>
            );

            // Coffee Page (default)
            return (
                <div className="min-h-screen bg-white p-4 pb-24 flex items-center justify-center">
                    <div className="max-w-md w-full text-center px-4">
                        <div className="w-48 h-48 mx-auto mb-8 text-pink-500 flex items-center justify-center">
                            <svg width="192" height="192" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                                <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                                <line x1="6" y1="1" x2="6" y2="4"></line>
                                <line x1="10" y1="1" x2="10" y2="4"></line>
                                <line x1="14" y1="1" x2="14" y2="4"></line>
                            </svg>
                        </div>
                        <p className="text-xl mb-8">Tipping culture is out of control; however, this app is free - so if I've made you some money, buy me a coffee.</p>
                        <button onClick={() => {
                            // Try to open Venmo app first, fallback to web
                            const venmoUrl = 'venmo://paycharge?txn=pay&recipients=adrian-hutchins';
                            const venmoWebUrl = 'https://venmo.com/u/adrian-hutchins';
                            
                            // Try to open Venmo app
                            window.location.href = venmoUrl;
                            
                            // Fallback to web after 1 second if app doesn't open
                            setTimeout(() => {
                                window.open(venmoWebUrl, '_blank');
                            }, 1000);
                        }} className="w-full bg-gradient-to-br from-pink-100 to-pink-200 py-4 rounded-lg font-semibold">Buy Her a Coffee</button>
                        <p className="text-xs text-gray-500 mt-4">Venmo: @adrian-hutchins</p>
                    </div>
                    <div className="fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg" style={{paddingBottom: 'env(safe-area-inset-bottom)'}}>
                        <div className="flex justify-around max-w-lg mx-auto px-4 py-4">
                            <button onClick={() => setCurrentPage('main')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Home /><span className="text-xs">Home</span></button>
                            <button onClick={() => setCurrentPage('predictions')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><Clock /><span className="text-xs">Predictions</span></button>
                            <button onClick={() => setCurrentPage('feedback')} className="flex flex-col items-center gap-1 text-gray-400" style={{marginTop: '-2px'}}><MessageSquare /><span className="text-xs">Feedback</span></button>
                            <button onClick={() => setCurrentPage('coffee')} className="flex flex-col items-center gap-1 text-pink-500" style={{marginTop: '-2px'}}><Coffee /><span className="text-xs">Coffee</span></button>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<QuickMovers />, document.getElementById('root'));
    </script>
</body>
</html>
